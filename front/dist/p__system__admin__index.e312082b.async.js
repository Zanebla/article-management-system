"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[594],{40362:function(oe,W,i){i.r(W),i.d(W,{default:function(){return Me}});var z=i(17061),v=i.n(z),G=i(17156),y=i.n(G),Y=i(27424),F=i.n(Y),ae=i(78565),V=i(66646),D=i(2453),A=i(96365),b=i(26713),T=i(71577),m=i(67294),N=i(51042),H=i(42122),x=i.n(H),g=i(78158);function de(r,s){return Q.apply(this,arguments)}function Q(){return Q=y()(v()().mark(function r(s,C){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.WY)("/api/admin/add",x()({method:"POST",headers:{"Content-Type":"application/json"},data:s},C||{})));case 1:case"end":return u.stop()}},r)})),Q.apply(this,arguments)}function ce(r,s){return J.apply(this,arguments)}function J(){return J=y()(v()().mark(function r(s,C){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.WY)("/api/admin/delete",x()({method:"POST",headers:{"Content-Type":"application/json"},data:s},C||{})));case 1:case"end":return u.stop()}},r)})),J.apply(this,arguments)}function ve(r,s){return X.apply(this,arguments)}function X(){return X=y()(v()().mark(function r(s,C){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.WY)("/api/admin/get",x()({method:"GET",params:x()({},s)},C||{})));case 1:case"end":return u.stop()}},r)})),X.apply(this,arguments)}function fe(r,s){return q.apply(this,arguments)}function q(){return q=y()(v()().mark(function r(s,C){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.WY)("/api/admin/list",x()({method:"POST",headers:{"Content-Type":"application/json"},data:s},C||{})));case 1:case"end":return u.stop()}},r)})),q.apply(this,arguments)}function me(r){return _.apply(this,arguments)}function _(){return _=y()(v()().mark(function r(s){return v()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,g.WY)("/api/admin/listModules",x()({method:"GET"},s||{})));case 1:case"end":return h.stop()}},r)})),_.apply(this,arguments)}function he(r,s){return ee.apply(this,arguments)}function ee(){return ee=y()(v()().mark(function r(s,C){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,g.WY)("/api/admin/update",x()({method:"POST",headers:{"Content-Type":"application/json"},data:s},C||{})));case 1:case"end":return u.stop()}},r)})),ee.apply(this,arguments)}var ne=i(62113),pe=i(34994),Z=i(5966),ie=i(64317),ge=i(69400),Ce=i(58131),ye=i(861),le=i.n(ye),ue=i(32808),xe=i(64240),Se=i(81064),Pe=i.n(Se),be=[{path:"/user",layout:!1,routes:[{name:"login",path:"/user/login",component:"./User/Login"}]},{path:"/welcome",name:"welcome",icon:"smile",component:"./Welcome"},{path:"/base",name:"base",icon:"appstore",routes:[{path:"/base/department",name:"department",component:"./base/department",access:"hasPrivilege"},{path:"/base/article",name:"article",component:"./base/article",access:"hasPrivilege"},{path:"/base/fullsearch",name:"fullsearch",component:"./base/fullsearch",access:"hasPrivilege"}]},{path:"/system",name:"system",icon:"crown",routes:[{path:"/system/admin",name:"admin",component:"./system/admin",access:"hasPrivilege"},{path:"/system/loginLog",name:"loginLog",component:"./system/loginLog",access:"hasPrivilege"},{path:"/system/onlineUser",name:"onlineUser",component:"./system/onlineUser",access:"hasPrivilege"}]},{path:"/",redirect:"/welcome"},{path:"*",layout:!1,component:"./404"}],je=i(85065),l=i(85893),Ae=m.forwardRef(function(r,s){var C=(0,je.useIntl)(),h=(0,m.useState)([]),u=F()(h,2),I=u[0],$=u[1],R=(0,m.useState)([]),E=F()(R,2),M=E[0],B=E[1],O=(0,m.useCallback)(function(){var e=[];M.forEach(function(t){var a=[];t.privilegeList.forEach(function(o){return a.push(o.id)}),e.push({id:t.id,privList:a})}),r.onChange&&r.onChange(e)},[M]),k=(0,m.useCallback)(function(){r.onChange&&r.onChange([])},[]),L=function(t){var a,o=((a=r.value)===null||a===void 0?void 0:a.filter(function(f){return f.id!==t}))||[];r.onChange&&r.onChange(o)},p=function(t){var a,o=((a=r.value)===null||a===void 0?void 0:a.filter(function(S){return S.id!==t}))||[],f=M.find(function(S){return S.id===t});if(f){var c=[];f.privilegeList.forEach(function(S){return c.push(S.id)}),o.push({id:t,privList:c}),r.onChange&&r.onChange(o)}};(0,m.useImperativeHandle)(s,function(){return{selectAll:O,clearSelections:k}}),(0,m.useEffect)(function(){me().then(function(t){return B(t||[])});var e=[];be.forEach(function(t){!t.name||t.name==="welcome"||!t.routes||t.routes.length==0||t.routes.forEach(function(a){!a.name||a.hideInMenu||e.push({resourceKey:a.name,description:C.formatMessage({id:"menu.".concat(t.name,".").concat(a.name)}),folder:C.formatMessage({id:"menu.".concat(t.name)})})})}),$(e)},[]);var d=function(t,a){var o=le()(r.value||[]),f=o.find(function(c){return c.id===a});f?f.privList=t:o.push({id:a,privList:t}),r.onChange&&r.onChange(o)},n=[{title:"\u83DC\u5355\u76EE\u5F55",width:120,dataIndex:"folder",render:function(t){return(0,l.jsxs)("span",{children:[(0,l.jsx)(Pe(),{style:{marginRight:2,color:"green"}}),t]})}},{title:"\u6A21\u5757\u540D\u79F0",width:120,dataIndex:"description",render:function(t,a){var o,f,c,S,j,K,re,te,P=M.find(function(U){return U.id===a.resourceKey});if(!(P!=null&&(o=P.privilegeList)!==null&&o!==void 0&&o.length))return t;var w=(f=r.value)===null||f===void 0?void 0:f.find(function(U){return U.id===a.resourceKey}),se=!!(P!=null&&(c=P.privilegeList)!==null&&c!==void 0&&c.length)&&(P==null||(S=P.privilegeList)===null||S===void 0?void 0:S.length)===(w==null||(j=w.privList)===null||j===void 0?void 0:j.length);return(0,l.jsx)(ue.Z,{onClick:function(){se?L(a.resourceKey):p(a.resourceKey)},checked:se,indeterminate:!!(w!=null&&(K=w.privList)!==null&&K!==void 0&&K.length)&&(P==null||(re=P.privilegeList)===null||re===void 0?void 0:re.length)!==(w==null||(te=w.privList)===null||te===void 0?void 0:te.length),children:t})}},{title:"\u6743\u9650",dataIndex:"resourceKey",render:function(t){var a,o=M.find(function(j){return j.id===t}),f=[];o&&o.privilegeList.forEach(function(j){return f.push({label:j.description,value:j.id})});var c=[],S=(a=r.value)===null||a===void 0?void 0:a.find(function(j){return j.id===t});return S&&(c=le()(S.privList)),(0,l.jsx)(ue.Z.Group,{disabled:r.disabled,value:c,options:f,onChange:function(K){return d(K,t)}})}}];return(0,l.jsx)(xe.Z,{size:"small",scroll:{y:300},rowKey:function(t){return"row".concat(t.resourceKey)},columns:n,dataSource:I||[],pagination:!1,loading:!1})});function Ee(r){var s=(0,m.useRef)([]),C=(0,m.useState)(0),h=F()(C,2),u=h[0],I=h[1],$=(0,m.useRef)(null),R=(0,m.useState)(!1),E=F()(R,2),M=E[0],B=E[1],O=(0,m.useCallback)(function(){var L=y()(v()().mark(function p(d){var n,e,t;return v()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!d){o.next=7;break}return o.next=3,ve({id:d});case 3:n=o.sent,n&&(s==null||(e=s.current)===null||e===void 0||e.forEach(function(f){var c;f==null||(c=f.current)===null||c===void 0||c.setFieldsValue(x()(x()({},n),{},{sex:n.sex?"1":"0",enabled:"".concat(n.enabled)}))}),B(n.userCode==="root")),o.next=11;break;case 7:return B(!1),o.next=10,(0,g.pQ)();case 10:s==null||(t=s.current)===null||t===void 0||t.forEach(function(f){var c;f==null||(c=f.current)===null||c===void 0||c.setFieldsValue({sex:"1",enabled:"true"})});case 11:case"end":return o.stop()}},p)}));return function(p){return L.apply(this,arguments)}}(),[]);(0,m.useEffect)(function(){I(0),O(r.id)},[r.id,r.visible]);var k=function(){var L=y()(v()().mark(function p(d){return v()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(d),!r.id){e.next=6;break}return e.next=4,he(x()(x()({},d),{},{id:r.id}));case 4:e.next=8;break;case 6:return e.next=8,de(d);case 8:return D.ZP.success("\u4FDD\u5B58\u6210\u529F"),r.onClose(!0),e.abrupt("return",!0);case 11:case"end":return e.stop()}},p)}));return function(d){return L.apply(this,arguments)}}();return(0,l.jsxs)(ne.L,{formMapRef:s,current:u,onCurrentChange:I,stepsProps:{size:"small"},stepsFormRender:function(p,d){return(0,l.jsx)(ge.Z,{width:800,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:r.id?"\u4FEE\u6539\u64CD\u4F5C\u5458":"\u65B0\u5EFA\u64CD\u4F5C\u5458",open:r.visible,footer:d,onCancel:function(){r.onClose(!1)},children:p})},submitter:{render:function(p){return p.step===0?(0,l.jsx)(T.ZP,{type:"primary",onClick:function(){var n;return(n=p.onSubmit)===null||n===void 0?void 0:n.call(p)},children:"\u4E0B\u4E00\u6B65"}):[(0,l.jsx)(T.ZP,{onClick:function(){var n;return(n=p.onPre)===null||n===void 0?void 0:n.call(p)},children:"\u4E0A\u4E00\u6B65"},"gotoOne"),(0,l.jsx)(T.ZP,{onClick:function(){var n;return(n=$.current)===null||n===void 0?void 0:n.selectAll()},children:"\u5168\u9009"},"selectAll"),(0,l.jsx)(T.ZP,{onClick:function(){var n;return(n=$.current)===null||n===void 0?void 0:n.clearSelections()},children:"\u6E05\u9664\u5168\u9009"},"clearSel"),(0,l.jsx)(T.ZP,{type:"primary",onClick:function(){var n;return(n=p.onSubmit)===null||n===void 0?void 0:n.call(p)},children:"\u63D0\u4EA4"},"submit")]}},onFinish:k,children:[(0,l.jsx)(ne.L.StepForm,{title:"\u57FA\u672C\u4FE1\u606F",children:(0,l.jsxs)(pe.A.Group,{children:[(0,l.jsx)(Z.Z,{name:"userCode",label:"\u767B\u5F55\u540D\u79F0",disabled:!!r.id,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u767B\u5F55\u540D\u79F0\uFF01"}]}),(0,l.jsx)(Z.Z,{name:"name",label:"\u59D3\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D\uFF01"}]}),(0,l.jsx)(ie.Z,{name:"sex",width:"xs",label:"\u6027\u522B",valueEnum:{0:"\u5973",1:"\u7537"}}),(0,l.jsx)(Z.Z.Password,{name:"password",placeholder:r.id?"\u4E3A\u7A7A\u5219\u4E0D\u4FEE\u6539\u5BC6\u7801":"\u8BF7\u8F93\u5165\u5BC6\u7801",fieldProps:{defaultValue:"",autoComplete:"new-password"},label:"\u5BC6\u7801",rules:[{required:!r.id,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,l.jsx)(Z.Z,{name:"department",label:"\u90E8\u95E8"}),(0,l.jsx)(Z.Z,{name:"email",label:"\u7535\u5B50\u90AE\u7BB1"}),(0,l.jsx)(Z.Z,{name:"phone",label:"\u624B\u673A\u53F7"}),(0,l.jsx)(ie.Z,{name:"enabled",width:"xs",label:"\u72B6\u6001",valueEnum:{false:"\u7981\u7528",true:"\u542F\u7528"}})]})}),(0,l.jsx)(ne.L.StepForm,{title:"\u6743\u9650",children:(0,l.jsx)(Ce.Z.Item,{name:"modList",children:(0,l.jsx)(Ae,{ref:$,disabled:M})})})]})}var Le=i(36505),Me=function(){var r=(0,m.useState)(!1),s=F()(r,2),C=s[0],h=s[1],u=(0,m.useRef)(null),I=(0,m.useState)(),$=F()(I,2),R=$[0],E=$[1],M=(0,m.useState)([]),B=F()(M,2),O=B[0],k=B[1],L=function(n){!n||n.length===0||(0,Le.BB)("\u60A8\u786E\u5B9A\u8981\u5220\u9664\u9009\u5B9A\u7684".concat(n.length,"\u4E2A\u7528\u6237\u5417\uFF1F"),y()(v()().mark(function e(){var t,a,o;return v()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ce(n);case 2:o=c.sent,D.ZP.success("\u6210\u529F\u7684\u5220\u9664\u4E86".concat(o,"\u6761\u8BB0\u5F55\uFF01")),(t=u.current)===null||t===void 0||t.clearSelected(),(a=u.current)===null||a===void 0||a.reload();case 6:case"end":return c.stop()}},e)})))},p=[{title:"\u7528\u6237ID",dataIndex:"userCode",fixed:!0,width:100,search:!1,tip:"\u7528\u6237ID\u552F\u4E00",render:function(n,e){return(0,l.jsx)("a",{onClick:function(){E(e.id),h(!0)},children:n})}},{title:"\u5173\u952E\u8BCD",key:"keyword",hideInTable:!0,renderFormItem:function(n,e){var t=e.type;return t==="form"?null:(0,l.jsx)(A.Z,{allowClear:!0})}},{title:"\u59D3\u540D",search:!1,dataIndex:"name",width:100},{title:"\u6027\u522B",dataIndex:"sex",search:!1,width:60,render:function(n,e){return e!=null&&e.sex?"\u7537":"\u5973"}},{title:"\u72B6\u6001",dataIndex:"enabled",search:!1,width:60,render:function(n,e){return e!=null&&e.enabled?"\u542F\u7528":"\u7981\u7528"}},{title:"\u7535\u8BDD",search:!1,dataIndex:"phone",width:100},{title:"\u7535\u5B50\u90AE\u4EF6",dataIndex:"email",search:!1,width:100},{title:"\u90E8\u95E8",dataIndex:"department",search:!1,ellipsis:!0},{title:"\u521B\u5EFA\u4EBA",dataIndex:"createdByDesc",search:!1,width:100},{title:"\u4E0A\u6B21\u66F4\u65B0",width:150,search:!1,sorter:!0,dataIndex:"updatedAt",valueType:"dateTime"},{title:"\u64CD\u4F5C",width:100,fixed:"right",dataIndex:"option",valueType:"option",render:function(n,e){return[(0,l.jsx)("a",{onClick:function(){E(e.id),h(!0)},children:"\u4FEE\u6539"},"modify"),(0,l.jsx)("a",{onClick:function(){L([e.id])},children:"\u5220\u9664"},"delete")]}}];return(0,l.jsxs)(ae._z,{children:[(0,l.jsx)(V.Z,{actionRef:u,rowKey:"id",scroll:{x:100},search:{labelWidth:120},request:y()(v()().mark(function d(){var n,e=arguments;return v()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.length>0&&e[0]!==void 0?e[0]:{},a.t0=g.o1,a.next=4,fe(n);case 4:return a.t1=a.sent,a.abrupt("return",(0,a.t0)(a.t1));case 6:case"end":return a.stop()}},d)})),tableAlertOptionRender:function(){return(0,l.jsxs)(b.Z,{size:16,children:[(0,l.jsx)("a",{onClick:function(){return L(O)},children:"\u6279\u91CF\u5220\u9664"}),(0,l.jsx)("a",{onClick:function(){var e;return(e=u.current)===null||e===void 0?void 0:e.clearSelected()},children:"\u53D6\u6D88\u9009\u62E9"})]})},toolBarRender:function(){return[(0,l.jsxs)(T.ZP,{type:"primary",onClick:function(){E(void 0),h(!0)},children:[(0,l.jsx)(N.Z,{})," \u65B0\u5EFA"]},"primary")]},columns:p,rowSelection:{onChange:function(n){k(n)}}}),(0,l.jsx)(Ee,{visible:C,onClose:function(n){if(n){var e;(e=u.current)===null||e===void 0||e.reload()}h(!1),E(void 0)},id:R})]})}},36505:function(oe,W,i){i.d(W,{BB:function(){return V}});var z=i(17061),v=i.n(z),G=i(17156),y=i.n(G),Y=i(69400),F=function(A,b){notification.open({message:A,duration:null,description:b})},ae=function(A,b){return A?(A=A.toLowerCase(),b=b.toLowerCase(),A.indexOf(b)>=0):!1};function V(D,A){return new Promise(function(b){var T=Y.Z.confirm({centered:!0,title:D,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onCancel:function(){return b(!1)},onOk:function(){var m=y()(v()().mark(function H(){return v()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return T.update({okButtonProps:{loading:!0}}),g.prev=1,g.next=4,A();case 4:b(!0),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(1),b(!1);case 10:case"end":return g.stop()}},H,null,[[1,7]])}));function N(){return m.apply(this,arguments)}return N}()})})}}}]);
